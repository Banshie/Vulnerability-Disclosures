# Banshie-2022-0001
## Description
Heimdal Premium Security for Windows contains a local privilege escalation vulnerability prior to and including version 2.5.395

## CVE Reference
CVE-2022-24618 (CVSS 7.8)

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce

## Details
The installation of the Heimdal Premium Security components uses the Windows Installer framework and an MSI file is cached in `c:\windows\installer`. An unprivileged user can trigger a repair operation, either by using the Windows Installer API or by running `msiexec.exe /fa c:\windows\installer\[XXXXX].msi`.

Running a repair operation will trigger a custom installer (Heimdal.Wizard.exe) running in SYSTEM context (started via the Windows Installer service). During the repair process the user can open a "Browse For Folder" window and via this window execute a shell prompt running in SYSTEM context, by holding shift and right clicking in the window.

## Resolution
Patch was issued on 16-Feb-2022 by vendor Heimdal Security.

## Discovery Credits
- Johannes Hatting, Banshie

## Disclosure Timeline
- 01-Feb-2022 Issue reported to Heimdal Security
- 14-Feb-2022 Vendor confirms the issue and a fix scheduled for release shortly thereafter
- 16-Feb-2022 Patched version released by Heimdal Security
 
## External References
- https://heimdalsecurity.com/
- https://support.heimdalsecurity.com/hc/en-us/articles/4425942979473-2-5-398-PROD-and-2-5-401-RC
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24618
- https://nvd.nist.gov/vuln/detail/CVE-2022-24618