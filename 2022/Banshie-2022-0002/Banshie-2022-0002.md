# Banshie-2022-0002
## Description
Dell Command | Integration Suite for System Center, versions prior to 6.2.0, contains arbitrary file write vulnerability. A locally authenticated malicious user could potentially exploit this vulnerability in order to perform an arbitrary write as system.

## CVE Reference
CVE-2022-34373 (CVSS 7.3)

## Impact
High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges.

## Exploitability
Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce.

## Details
The Dell AWE service, while running as SYSTEM, creates a log file `IntelvProOutOfBand.log` in the path: `C:\ProgramData\Dell\CommandIntegrationSuite\Logs\` and sets a DACL which gives the group `Everyone` Full Control of the file. By creating a directory junction and file symbolic link, an attacker can abuse the service to create an arbitrary file anywhere on the target host. The vulnerability can be leverage to escalate privileges and execute code in the context of SYSTEM.

## Resolution
Patch was issued on 26-Jul-2022 by vendor Dell.

## Discovery Credits
- Johannes Hatting, Banshie

## Disclosure Timeline
- 04-Jun-2022 Issue reported to Dell
- 07-Jun-2022 Vendor confirms the issue and a fix scheduled for release shortly thereafter
- 26-Jul-2022 Patched version released by Dell
 
## External References
- https://www.dell.com/support/kbdoc/en-ed/000201877/dsa-2022-201-dell-command-integration-suite-for-system-center-security-update-for-arbitrary-file-write-vulnerability
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34373
- https://nvd.nist.gov/vuln/detail/CVE-2022-34373
